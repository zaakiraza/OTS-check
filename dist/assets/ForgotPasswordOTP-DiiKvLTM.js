import{w as T,r as a,e as P,q as y,j as r,B as f,H as C,T as l,V as R,g as v}from"./index-BK1bU2bz.js";import{B as E}from"./BOX-CozHWWeK.js";import{H as W}from"./h-stack-Bagx0LFm.js";import{I}from"./input-lBRgIHT7.js";import"./use-form-control-Bfrk_d33.js";import"./form-control-Bp5uebuv.js";function H(){const{verifyOtp:h,userEmail:c,resendOtp:g}=T(),[p,x]=a.useState(["","","",""]),d=a.useRef([]),[o,u]=a.useState(60),[n,m]=a.useState(!1),F=P(),i=y();a.useEffect(()=>{let t;return o>0&&(t=setInterval(()=>{u(s=>s-1)},1e3)),()=>clearInterval(t)},[o]);const w=async t=>{var s;if(!t){i({title:"Missing Email",description:"Email is required to resend OTP.",status:"warning",duration:4e3,isClosable:!0,position:"top"});return}m(!0),u(60);try{const e=await g(t);i({title:e.success?"Success":"Failed",description:e.message,status:e.success?"success":"error",duration:4e3,isClosable:!0,position:"top"}),e.success&&(x(["","","",""]),(s=d.current[0])==null||s.focus())}catch{i({title:"Error",description:"Failed to resend OTP. Please try again.",status:"error",duration:4e3,isClosable:!0,position:"top"})}finally{m(!1)}},S=t=>{const s=Math.floor(t/60).toString().padStart(2,"0"),e=(t%60).toString().padStart(2,"0");return`${s}:${e}`},j=(t,s)=>{var e;if(o!==0&&/^\d*$/.test(t)){const b=[...p];b[s]=t,x(b),t&&s<3&&((e=d.current[s+1])==null||e.focus())}},O=async t=>{if(t.preventDefault(),o===0){i({title:"OTP Expired",description:"OTP has expired. Please request a new one.",status:"error",duration:4e3,isClosable:!0,position:"top"});return}const s=p.join("");if(s.length!==4){i({title:"Incomplete OTP",description:"Please enter the full 4-digit OTP.",status:"warning",duration:4e3,isClosable:!0,position:"top"});return}try{const e=await h(s,c);if(!e.success)throw new Error(e.message);F("/resetpassword")}catch(e){i({title:"Verification Failed",description:e.message,status:"error",duration:4e3,isClosable:!0,position:"top"})}};return r.jsx(E,{children:r.jsxs(f,{p:{base:"24px",sm:"32px",md:"36px"},mt:{base:"136px",sm:"156px",md:"194px"},borderRadius:"24px",boxShadow:"2xl",maxW:{base:"75%",md:"85%",lg:"100%"},width:"350px",bgGradient:"linear(to-br, #FFFFFF00 0%, #FFFFFF20 100%)",border:"1px solid #FFFFFF35",backdropFilter:"blur(24px)",children:[r.jsx(C,{color:"#F49040",textAlign:"center",mt:{base:"2px",sm:"8px",md:"12px"},mb:{base:"8px",sm:"14px",md:"18px"},fontSize:{base:"24px",sm:"32px",md:"32px"},fontWeight:"bold",children:"Verification OTP"}),r.jsxs(l,{fontWeight:"light",color:"#FFFFFF",textAlign:"center",mb:{base:"16px",sm:"24px",md:"36px"},fontSize:{base:"14px",sm:"16px",md:"18px"},children:["We have sent you a verification code to",r.jsxs(l,{as:"span",fontWeight:"semibold",color:"#F49040",children:[" ",c]})]}),r.jsxs("form",{onSubmit:O,children:[r.jsx(W,{spacing:4,justify:"center",mb:{base:"16px",sm:"18px",md:"24px"},children:p.map((t,s)=>r.jsx(I,{placeholder:"-",type:"text",inputMode:"numeric",maxLength:1,value:t,onChange:e=>j(e.target.value,s),ref:e=>d.current[s]=e,textAlign:"center",fontSize:{base:"14px",sm:"16px",md:"18px"},borderRadius:"12px",border:"1px solid #CED4D3",width:{base:"40px",sm:"48px",md:"56px"},height:{base:"40px",sm:"48px",md:"56px"},bg:"white",isDisabled:o===0,_focus:{borderColor:"#F49040",boxShadow:"0px 2px 5px #F49040"}},s))}),r.jsx(f,{fontSize:{base:"12px",sm:"14px",md:"16px"},fontWeight:"semi-bold",textAlign:"center",color:"white",mb:4,children:o===0?r.jsx(l,{color:n?"#ccc":"#F49040",cursor:n?"not-allowed":"pointer",onClick:()=>!n&&w(c),children:n?"Resending...":"Resend OTP"}):S(o)}),r.jsx(R,{spacing:3,children:r.jsx(v,{type:"submit",isDisabled:o===0||p.some(t=>t===""),mb:{base:"2px",sm:"8px",md:"12px"},bg:"#F49040",color:"white",width:"full",borderRadius:"30px",h:{base:"34px",sm:"42px",md:"48px"},fontSize:{base:"14px",sm:"16px",md:"18px"},_hover:{border:"2px solid #F49040",color:"#F49040",bg:"none",boxShadow:"0px 2px 5px #F49040"},isLoading:n,children:"Verify"})})]})]})})}export{H as default};
