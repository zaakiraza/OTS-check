import{r,w as Q,x as Z,v as ee,e as se,q as oe,j as e,B as t,H as te,V as re,T as a,g as I,s as ie,A as ne}from"./index-BK1bU2bz.js";import{G as ae,a as A,b as z,c as G}from"./index-DCMqzWIr.js";import{F as le}from"./index-DwK6vdq7.js";import{B as pe}from"./BOX-CozHWWeK.js";import{G as _,h as de,g as xe,O as ce}from"./oauthConfig-CU22yB20.js";import{F as g}from"./form-control-Bp5uebuv.js";import{F as h}from"./form-label-6_09-6oI.js";import{I as b,b as f,a as v}from"./input-element-CVDJCgEx.js";import{I as F}from"./input-lBRgIHT7.js";import{C as me}from"./checkbox-CcSLJvEw.js";import{C as ue}from"./center-Zpce6yHc.js";import{D as L}from"./divider-BaZMI-1_.js";import"./use-form-control-Bfrk_d33.js";import"./visually-hidden.style-Bfr07Aua.js";const Le=()=>{const[p,k]=r.useState(!1),[d,O]=r.useState(!1),[ge,P]=r.useState(""),[he,U]=r.useState(""),[x,w]=r.useState(""),[c,S]=r.useState(""),[j,C]=r.useState(""),[W,T]=r.useState(!1),[N,y]=r.useState(!1),[D,l]=r.useState(!1),{registerUser:B,newUser:be,setLoginUserInfo:H,setUserLoginToken:M}=Q(),{clearOtpSession:q}=Z(),{getEnrollmentsByStudentId:V}=ee(),m=se(),n=oe(),R=()=>k(!p),E=()=>O(!d),J=()=>m("/login");r.useEffect(()=>{const s=()=>{if(window.google)i();else{const o=document.createElement("script");o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.onload=i,document.head.appendChild(o)}},i=()=>{window.google&&_.clientId&&window.google.accounts.id.initialize({client_id:_.clientId,callback:X,auto_select:!1,cancel_on_tap_outside:!0})};s()},[]);const X=async s=>{try{l(!0);const i=await ie.post("http://localhost:5003/auth/google/signup",{idToken:s.credential});if(i.data.success){const{user:o,token:u}=i.data.data;H(o),M(u),localStorage.setItem("userToken",u),localStorage.setItem("userInfo",JSON.stringify(o)),localStorage.setItem("userId",o.id),n({title:"Account Created Successfully",description:`Welcome, ${o.firstName||o.username}!`,status:"success",duration:5e3,isClosable:!0}),(await V(o.id,u)).status===!1?m("/explore/category"):window.open("/dashboard","_blank")}else n({title:"Signup Failed",description:i.data.message||"Google signup failed",status:"error",duration:5e3,isClosable:!0})}catch(i){console.error("Google signup error:",i),n({title:"Signup Error",description:"An error occurred during Google signup. Please try again.",status:"error",duration:5e3,isClosable:!0})}finally{l(!1)}},Y=()=>{de(n)&&$()},$=()=>{try{l(!0),console.log("Environment VITE_API_URL:","http://localhost:5003/api"),console.log("API_BASE_URL from config:",ne);const s=xe("google","signup");console.log("Final OAuth URL for signup:",s),window.location.href=s}catch(s){console.error("OAuth redirect error:",s),l(!1),n({title:"Configuration Error",description:ce.CONFIGURATION_ERROR,status:"error",duration:5e3,isClosable:!0})}},K=async s=>{if(s.preventDefault(),q(),c!==j)return n({title:"Password mismatch",status:"error",position:"top",duration:1e3,isClosable:!0,render:()=>e.jsx(t,{bg:"#F49040",color:"white",px:6,py:3,borderRadius:"md",textAlign:"center",fontWeight:"medium",children:"Password Mismatch"})});const i={email:x,password:c,rememberMe:W,roleName:"Student"};localStorage.setItem("registeredUserEmail",x),y(!0);try{const o=await B(i);if(!o.success){n({title:o.message||"Registration failed.",status:"error",position:"top",duration:2e3,isClosable:!0,render:()=>e.jsx(t,{bg:"#F49040",color:"white",px:6,py:3,borderRadius:"md",textAlign:"center",fontWeight:"medium",children:o.message||"Registration failed."})});return}n({title:"Account created successfully!",description:"Please verify your email with the OTP sent.",status:"success",position:"top",duration:2e3,isClosable:!0,render:()=>e.jsxs(t,{bg:"#F49040",color:"white",px:6,py:3,borderRadius:"md",textAlign:"center",fontWeight:"medium",children:[e.jsx(a,{children:"Account created successfully!"}),e.jsx(a,{children:"Please verify your email with the OTP sent"})]})}),P(""),U(""),w(""),S(""),C(""),m("/signupotp")}catch(o){console.error("Error during signup:",o),n({title:"Something went wrong.",description:"Please try again later.",status:"error",position:"top",duration:2e3,isClosable:!0,render:()=>e.jsxs(t,{bg:"#F49040",color:"white",px:6,py:3,borderRadius:"md",textAlign:"center",fontWeight:"medium",children:[e.jsx(a,{children:"Something went wrong"}),e.jsx(a,{children:"Please try again later"})]})})}finally{y(!1)}};return e.jsx(pe,{children:e.jsxs(t,{p:{base:"14px",sm:"16px",md:"20px"},mt:{base:"130px",sm:"150px",md:"160px"},mb:{base:"15px",sm:"15px",md:"20px"},borderRadius:"16px",boxShadow:"xl",maxW:{base:"85%",md:"85%",lg:"85%"},width:{base:"300px",sm:"360px",md:"400px"},bgGradient:"linear(to-br, #FFFFFF00 0%, #FFFFFF20 100%)",border:"1px solid #FFFFFF35",backdropFilter:"blur(24px)",mx:"auto",children:[e.jsx(te,{maxW:"100%",color:"#F49040",textAlign:"center",mt:{base:"0px",sm:"2px",md:"4px"},mb:{base:"8px",sm:"10px",md:"16px"},fontSize:{base:"18px",sm:"20px",md:"22px"},fontWeight:"bold",children:"Create Your Account"}),e.jsxs(re,{spacing:{base:"6px",sm:"8px",md:"10px"},align:"stretch",as:"form",onSubmit:K,children:[e.jsxs(g,{isRequired:!0,children:[e.jsx(h,{color:"#FFF",fontSize:{base:"10px",sm:"11px"},mb:1,ml:2,fontWeight:"light",children:"Email"}),e.jsxs(b,{children:[e.jsx(f,{py:{base:"16px",sm:"18px",md:"20px"},mx:{base:"8px",sm:"10px",md:"12px"},children:e.jsx(t,{color:"#F49040",fontSize:{base:"14px",sm:"16px",md:"18px"},children:e.jsx(ae,{})})}),e.jsx(F,{placeholder:"Enter your email",bg:"white",py:{base:"16px",sm:"18px",md:"20px"},paddingLeft:{base:"44px",sm:"50px",md:"54px"},fontSize:{base:"12px",sm:"13px",md:"14px"},borderRadius:"25px",border:"1px solid #CED4D3",_focus:{outline:"none",boxShadow:"0px 0px 12px #F49040",border:"1px solid #F49040",bg:"white"},value:x,type:"email",onChange:s=>w(s.target.value)})]})]}),e.jsxs(g,{isRequired:!0,children:[e.jsx(h,{color:"#FFF",fontSize:{base:"10px",sm:"11px"},mb:1,ml:2,fontWeight:"light",children:"Create Password"}),e.jsxs(b,{children:[e.jsx(f,{pointerEvents:"none",height:"100%",display:"flex",alignItems:"center",paddingLeft:{base:"12px",sm:"15px",md:"18px"},children:e.jsx(t,{color:"#F49040",fontSize:{base:"14px",sm:"16px",md:"18px"},children:e.jsx(A,{})})}),e.jsx(F,{placeholder:"Enter your password",type:p?"text":"password",bg:"white",py:{base:"16px",sm:"18px",md:"20px"},paddingLeft:{base:"44px",sm:"50px",md:"54px"},paddingRight:{base:"44px",sm:"50px",md:"54px"},fontSize:{base:"12px",sm:"13px",md:"14px"},borderRadius:"25px",border:"1px solid #CED4D3",_focus:{outline:"none",boxShadow:"0px 0px 12px #F49040",border:"1px solid #F49040",bg:"white"},value:c,onChange:s=>S(s.target.value)}),e.jsx(v,{width:"3.5rem",py:{base:"16px",sm:"18px",md:"20px"},children:p?e.jsx(t,{fontSize:{base:"14px",sm:"16px",md:"18px"},children:e.jsx(z,{color:"#F49040",onClick:R,cursor:"pointer"})}):e.jsx(t,{fontSize:{base:"14px",sm:"16px",md:"18px"},children:e.jsx(G,{color:"#F49040",onClick:R,cursor:"pointer"})})})]})]}),e.jsxs(g,{isRequired:!0,children:[e.jsx(h,{color:"#FFF",fontSize:{base:"10px",sm:"11px"},mb:1,ml:2,fontWeight:"light",children:"Confirm Password"}),e.jsxs(b,{children:[e.jsx(f,{pointerEvents:"none",height:"100%",display:"flex",alignItems:"center",paddingLeft:{base:"12px",sm:"15px",md:"18px"},children:e.jsx(t,{color:"#F49040",fontSize:{base:"14px",sm:"16px",md:"18px"},children:e.jsx(A,{})})}),e.jsx(F,{placeholder:"Confirm your password",type:d?"text":"password",bg:"white",py:{base:"16px",sm:"18px",md:"20px"},paddingLeft:{base:"44px",sm:"50px",md:"54px"},paddingRight:{base:"44px",sm:"50px",md:"54px"},fontSize:{base:"12px",sm:"13px",md:"14px"},borderRadius:"25px",border:"1px solid #CED4D3",_focus:{outline:"none",boxShadow:"0px 0px 12px #F49040",border:"1px solid #F49040",bg:"white"},value:j,onChange:s=>C(s.target.value)}),e.jsx(v,{width:"3.5rem",py:{base:"16px",sm:"18px",md:"20px"},children:d?e.jsxs(t,{color:"#F49040",fontSize:{base:"14px",sm:"16px",md:"18px"},children:[e.jsx(z,{color:"#F49040",onClick:E,cursor:"pointer"})," "]}):e.jsx(t,{fontSize:{base:"14px",sm:"16px",md:"18px"},children:e.jsx(G,{color:"#F49040",onClick:E,cursor:"pointer"})})})]})]}),e.jsx(me,{colorScheme:"white",color:"#FFFFFF",mx:2,size:{base:"xs",sm:"sm",md:"md"},onChange:s=>T(s.target.checked),children:e.jsx(a,{fontSize:{base:"10px",sm:"11px",md:"12px"},children:"Remember me"})}),e.jsx(I,{isLoading:N,loadingText:"Registering",spinnerPlacement:"start",bg:"#F49040",color:"white",width:"full",borderRadius:"25px",type:"submit",h:{base:"30px",sm:"34px",md:"38px"},fontSize:{base:"12px",sm:"13px",md:"14px"},_hover:{border:"2px solid #F49040",color:"#F49040",bg:"none",boxShadow:"0px 2px 5px #F49040"},_focus:{outline:"none",boxShadow:"none"},children:"Register"}),e.jsxs(a,{color:"#FFFFFF",textAlign:"center",fontSize:{base:"10px",sm:"11px",md:"12px"},fontWeight:"light",children:["Already have an account?"," ",e.jsx(a,{as:"span",color:"#F49040",onClick:J,cursor:"pointer",fontSize:{base:"11px",sm:"12px",md:"13px"},fontWeight:"semibold",ml:"2px",children:"Login"})]})]}),e.jsxs(ue,{my:2,children:[e.jsx(L,{borderColor:"white",width:{base:"60px",sm:"80px",md:"100px"}}),e.jsx(a,{color:"white",mx:{base:"8px",sm:"10px",md:"12px"},fontSize:{base:"10px",sm:"11px",md:"12px"},fontWeight:"semibold",children:"OR"}),e.jsx(L,{borderColor:"white",width:{base:"60px",sm:"80px",md:"100px"}})]}),e.jsx(t,{maxW:{base:"95%",md:"580px"},width:"full",display:"flex",justifyContent:"center",children:e.jsxs(I,{variant:"outline",p:{base:"12px",sm:"14px",md:"16px"},maxW:"200px",maxH:"40px",width:"100%",bgColor:"white",borderRadius:"10px",mx:"auto",mb:"8px",fontSize:{base:"10px",sm:"12px",md:"13px"},isLoading:D,loadingText:"Connecting...",_focus:{outline:"none",boxShadow:"none",bg:"white"},_hover:{border:"none"},onClick:Y,children:[e.jsx(t,{as:le,boxSize:{base:"18px",sm:"20px",md:"22px"},mr:{base:"4px",sm:"6px"},fontSize:"12px"}),"Continue with Google"]})})]})})};export{Le as default};
